# Generated Berry code from Animation DSL
# Source: test_template_simple_reusable.anim
# 
# This file was automatically generated by compile_all_examples.sh
# Do not edit manually - changes will be overwritten

import animation

# Test template functionality
# Define a simple template
# Template animation class: pulse_effect
class pulse_effect_animation : animation.engine_proxy
  static var PARAMS = animation.enc_params({
    "base_color": {"type": "color"},
    "period": {"type": "time"},
    "brightness": {"type": "percentage"}
  })

  # Template setup method - overrides EngineProxy placeholder
  def setup_template()
    var engine = self   # using 'self' as a proxy to engine object (instead of 'self.engine')

    var pulse_ = animation.pulsating_animation(engine)
    pulse_.color = animation.create_closure_value(engine, def (engine) return self.base_color end)
    pulse_.period = animation.create_closure_value(engine, def (engine) return self.period end)
    pulse_.opacity = animation.create_closure_value(engine, def (engine) return self.brightness end)
    self.add(pulse_)
  end
end

# Use the template - templates add animations directly to engine and run them
# Auto-generated strip initialization (using Tasmota configuration)
var engine = animation.init_strip()

var main_ = pulse_effect_animation(engine)
main_.base_color = 0xFFFF0000
main_.period = 2000
main_.brightness = 204
engine.add(main_)
engine.run()


#- Original DSL source:
# Test template functionality

# Define a simple template
template animation pulse_effect {
  param base_color type color
  param period type time
  param brightness type percentage
  
  animation pulse = pulsating_animation(
    color=base_color
    period=period
  )
  pulse.opacity = brightness
  
  run pulse
}

# Use the template - templates add animations directly to engine and run them
animation main = pulse_effect(base_color = red, period = 2s, brightness = 80%)
run main
-#

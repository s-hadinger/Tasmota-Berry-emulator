<!DOCTYPE html><html lang="en" class=""><head><meta charset='utf-8'><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBACAAEAAQCwAAAAFgAAACgAAAAQAAAAIAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP5/b+H6X2/h8k9v4eZnb+Hud2/h7ndv4e53b+FmZm/hMkxv4ZgZb+HOc2/h5+dv4fPPb+H5n2/h/D9v4f5/b+EAAO4EAADuBAAA7gQAAO4EAADuBAAA7gQAAO4EAADuBAAA7gQAAO4EAADuBAAA7gQAAO4EAADuBAAA7gQAAO4E"><title>Tasmota Berry Animation Framework</title><script>var x=null,lt,to,tp,pc='';eb=s=>document.getElementById(s);qs=s=>document.querySelector(s);sp=i=>eb(i).type=(eb(i).type==='text'?'password':'text');wl=f=>window.addEventListener('load',f);function jd(){var t=0,i=document.querySelectorAll('input,button,textarea,select');while(i.length>=t){if(i[t]){i[t]['name']=(i[t].hasAttribute('id')&&(!i[t].hasAttribute('name')))?i[t]['id']:i[t]['name'];}t++;}}function sf(s){var t=0,i=document.querySelectorAll('.hf');while(i.length>=t){if(i[t]){i[t].style.display=s?'block':'none';}t++;}}wl(jd);function su(t){eb('f3').style.display='none';eb('f2').style.display='block';t.form.submit();}function upl(t){var sl=t.form['u2'].files[0].slice(0,1);var rd=new FileReader();rd.onload=()=>{var bb=new Uint8Array(rd.result);if(bb.length==1&&bb[0]==0xE9){fct(t);}else{t.form.submit();};};rd.readAsArrayBuffer(sl);return false;};function fct(t){var x=new XMLHttpRequest();x.open('GET','/u4?u4=fct&api=',true);x.onreadystatechange=()=>{if(x.readyState==4&&x.status==200){var s=x.responseText;if(s=='false')setTimeout(()=>{fct(t);},6000);if(s=='true')setTimeout(()=>{su(t);},1000);}else if(x.readyState==4&&x.status==0){setTimeout(()=>{fct(t);},2000);};};x.send();}</script><style>:root{--c_bg:#252525;--c_frm:#4f4f4f;--c_ttl:#eaeaea;--c_txt:#eaeaea;--c_txtwrn:#ff5661;--c_txtscc:#008000;--c_btn:#1fa3ec;--c_btnoff:#08405e;--c_btntxt:#faffff;--c_btnhvr:#0e70a4;--c_btnrst:#d43535;--c_btnrsthvr:#931f1f;--c_btnsv:#47c266;--c_btnsvhvr:#5aaf6f;--c_in:#dddddd;--c_intxt:#000000;--c_csl:#1f1f1f;--c_csltxt:#65c115;--c_tab:#999999;--c_tabtxt:#faffff;}div,fieldset,input,select{padding:5px;font-size:1em;}fieldset{background:var(--c_frm);}p{margin:0.5em 0;}input{width:100%;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;background:var(--c_in);color:var(--c_intxt);}input[type=checkbox],input[type=radio]{width:1em;margin-right:6px;vertical-align:-1px;}input[type=range]{width:99%;}select{width:100%;background:var(--c_in);color:var(--c_intxt);}textarea{resize:vertical;width:98%;height:318px;padding:5px;overflow:auto;background:var(--c_bg);color:var(--c_csltxt);}body{text-align:center;font-family:verdana,sans-serif;background:var(--c_bg);}td{padding:0px;}button{border:0;border-radius:0.3rem;background:var(--c_btn);color:var(--c_btntxt);line-height:2.4rem;font-size:1.2rem;width:100%;-webkit-transition-duration:0.4s;transition-duration:0.4s;cursor:pointer;}button:hover{background:var(--c_btnhvr);}.bred{background:var(--c_btnrst);}.bred:hover{background:var(--c_btnrsthvr);}.bgrn{background:var(--c_btnsv);}.bgrn:hover{background:var(--c_btnsvhvr);}a{color:var(--c_btn);text-decoration:none;}.p{float:left;text-align:left;}.q{float:right;text-align:right;}.r{border-radius:0.3em;padding:2px;margin:4px 2px;}.hf{display:none;}</style></head><body><div style='background:var(--c_bg);text-align:left;display:inline-block;color:var(--c_txt);min-width:340px;position:relative;'><div style='text-align:center;color:var(--c_ttl);'><noscript>To use Tasmota, please enable JavaScript<br></noscript><h3>ESP32S2</h3><h2>Tasmota</h2></div><style>.anim-container{min-width:350px;margin:0 auto;padding:10px;width:100%;max-width:none;}body > div{width:calc(100% - 20px) !important;max-width:1200px !important;display:block !important;box-sizing:border-box !important;}.anim-editor{width:100%;min-height:300px;font-family:monospace;font-size:12px;border:1px solid var(--c_frm);padding:8px;background:var(--c_intxt);color:#b19cd9;box-sizing:border-box;}.anim-output{width:100%;min-height:200px;font-family:monospace;font-size:11px;border:1px solid var(--c_frm);padding:8px;background:var(--c_intxt);color:#fb1;box-sizing:border-box;}.anim-error{color:var(--c_btnrst);background:#ffe6e6;padding:8px;border:1px solid var(--c_btnrst);margin:5px 0;}.anim-success{color:var(--c_btnsv);background:#e6ffe6;padding:8px;border:1px solid var(--c_btnsv);margin:5px 0;}button:disabled{opacity:0.5;cursor:not-allowed;}.textarea-container{position:relative;}.copy-btn{position:absolute;top:8px;right:0;width:20px;height:20px;cursor:pointer;user-select:none;transition:all 0.2s;background:transparent;border:none;}.anim-editor + .copy-btn::before,.anim-output + .copy-btn::before{content:'';position:absolute;top:2px;left:2px;width:10px;height:10px;border-left:2px solid var(--c_txt);border-top:2px solid var(--c_txt);background:transparent;}.anim-editor + .copy-btn::after,.anim-output + .copy-btn::after{content:'';position:absolute;top:6px;left:6px;width:10px;height:10px;border:2px solid var(--c_txt);}.copy-btn:hover::before,.copy-btn:hover::after{opacity:0.7;}.copy-message{position:absolute;top:35px;right:8px;background:var(--c_intxt);color:white;padding:4px 8px;border-radius:3px;font-size:11px;opacity:0;transition:opacity 0.3s;pointer-events:none;white-space:nowrap;}.copy-message.show{opacity:1;}</style><div class='anim-container'><h3>DSL Code Editor</h3><div class='textarea-container'><textarea id='dsl_code' class='anim-editor' spellcheck='false' placeholder='Enter your Berry Animation DSL code here...'># Vue-meter based on random data

berry """
# define a pseudo-random generator, returns value in range 0..255
def rand_meter(engine)
  return (engine.time_ms * 2654435761) & 0xFF
end
"""

extern function rand_meter      # declare the external function

# define a palette of rainbow colors including white with constant brightness
palette vue_meter_palette = [
  (  0, 0x00FF00)     # Green
  (143, 0x00FF00)

  (164, 0xFFFF00)     # Yellow
  (207, 0xFFFF00)

  (228, 0xFF0000)     # Red
  (255, 0xFF0000)
]

# define a color palette pattern for 'vue_meter_palette'
color rainbow_rich_color = rich_palette(palette=vue_meter_palette, cycle_period=0, transition_type=LINEAR)

# define a vue-meter based on all elements above
animation back_pattern = palette_meter_animation(color_source = rainbow_rich_color, level = rand_meter())

run back_pattern
</textarea><div class='copy-btn' onclick='copyDslCode()' title='Copy DSL code'></div><div id='dsl-copy-msg' class='copy-message'></div></div><div id='status-message'><div class='anim-success'><strong>Status:</strong> Ready</div></div><p></p><button id='btn-compile' onclick='sendAction("compile")' class='button bgrn'>Compile & Run</button><p></p><button id='btn-compile-only' onclick='sendAction("compile_only")' class='button'>Compile Only</button><p></p><button id='btn-stop' onclick='sendAction("stop")' class='button'>Stop Animation</button><h3>Generated Berry Code</h3><div class='textarea-container'><textarea id='berry_output' class='anim-output' readonly>import animation

# Vue-meter based on random data
# Auto-generated strip initialization (using Tasmota configuration)
var engine = animation.init_strip()

# Berry code block

# define a pseudo-random generator, returns value in range 0..255
def rand_meter(engine)
  return (engine.time_ms * 2654435761) &amp; 0xFF
end

# End berry code block
# External function declaration: rand_meter  # declare the external function
animation.register_user_function(&quot;rand_meter&quot;, rand_meter)
# define a palette of rainbow colors including white with constant brightness
var vue_meter_palette_ = bytes(
  &quot;0000FF00&quot;  # Green
  &quot;8F00FF00&quot;
  &quot;A4FFFF00&quot;  # Yellow
  &quot;CFFFFF00&quot;
  &quot;E4FF0000&quot;  # Red
  &quot;FFFF0000&quot;
)
# define a color palette pattern for &apos;vue_meter_palette&apos;
var rainbow_rich_color_ = animation.rich_palette(engine)
rainbow_rich_color_.palette = vue_meter_palette_
rainbow_rich_color_.cycle_period = 0
rainbow_rich_color_.transition_type = animation.LINEAR
# define a vue-meter based on all elements above
var back_pattern_ = animation.palette_meter_animation(engine)
back_pattern_.color_source = rainbow_rich_color_
back_pattern_.level = animation.create_closure_value(engine, def (engine) return animation.get_user_function(&apos;rand_meter&apos;)(engine) end)
engine.add(back_pattern_)
engine.run()
</textarea><div class='copy-btn' onclick='copyBerryCode()' title='Copy Berry code'></div><div id='berry-copy-msg' class='copy-message'></div></div><div></div><p></p><form id=but6 style="display:block;" action='mn' method='get'><button>Tools</button></form><script>function showStatus(message,isError){var statusDiv=eb('status-message');if(message){statusDiv.innerHTML='<div class="anim-'+(isError?'error':'success')+'"><strong>'+(isError?'Error':'Success')+':</strong> '+message+'</div>';}else{statusDiv.innerHTML='';}}function showProcessingStatus(){var statusDiv=eb('status-message');statusDiv.innerHTML='<div class="anim-success"><strong>Status:</strong> Processing...</div>';}function setButtonsDisabled(disabled){var btnIds=['btn-compile','btn-compile-only','btn-stop'];for(var i=0;i<btnIds.length;i++){var btn=eb(btnIds[i]);if(btn)btn.disabled=disabled;}}function sendAction(action){setButtonsDisabled(true);showProcessingStatus();var xhr=new XMLHttpRequest();var formData=new FormData();formData.append('action',action);if(action!=='stop'&&action!=='clear'){formData.append('dsl_code',eb('dsl_code').value);}xhr.open('POST','/berry_anim?api=action',true);xhr.onreadystatechange=function(){if(xhr.readyState===4){setButtonsDisabled(false);if(xhr.status===200){try{var result=JSON.parse(xhr.responseText);if(result.success){showStatus(result.message,false);if(result.berry_code!==undefined){eb('berry_output').value=result.berry_code;}if(result.dsl_code!==undefined){eb('dsl_code').value=result.dsl_code;}}else{showStatus(result.error,true);if(result.error.includes('Compilation failed')){eb('berry_output').value='# Compilation failed\n# '+result.error;}}}catch(e){showStatus('Invalid response from server',true);}}else{showStatus('Network error: '+xhr.status,true);}}};xhr.send(formData);}function showCopyMessage(msgId,text,isError){var msgDiv=eb(msgId);msgDiv.textContent=text;msgDiv.style.background='color-mix(in srgb, var('+(isError?'--c_btnrst':'--c_btnsv')+') 90%, transparent)';msgDiv.classList.add('show');setTimeout(function(){msgDiv.classList.remove('show');},2000);}function copyTextarea(textareaId,msgId){var textarea=eb(textareaId);textarea.select();textarea.setSelectionRange(0,99999);try{document.execCommand('copy');showCopyMessage(msgId,'Copied!',false);}catch(err){showCopyMessage(msgId,'Copy failed',true);}}function copyDslCode(){copyTextarea('dsl_code','dsl-copy-msg');}function copyBerryCode(){copyTextarea('berry_output','berry-copy-msg');}</script><p></p><div style='text-align:right;font-size:11px;'><hr><a href='https://github.com/arendst/Tasmota' target='_blank' style='color:#aaa;'>Tasmota 15.1.0.3 (tasmota) by Theo Arends</a></div></div></body></html>